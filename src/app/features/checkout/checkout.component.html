@if (busyService.loading)
{
    <div class="bg-white z-50 flex items-center justify-center w-screen h-[70vh] overflow-hidden">
        <img src="assets/loading/bookLoading.gif" alt="Loading..." class="w-[800px] max-w-none h-auto object-none" />
    </div>
}
@else {
    <div class="container xs:max-w-screen-2xl mx-auto border-t border-gray-300 py-3 px-4 sm:px-6 md:px-8 lg:px-6 xl:px-2 min-h-[70vh]">
        <div class="mx-auto lg:flex md:space-x-6 xl:px-0 mt-2">
            <div class="w-full ">

                <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()" id="checkoutForm">
                    <div class="rounded-lg bg-white p-6 shadow-sm">
                        <h1 class="text-xl font-bold">Contact Info</h1>
                        <p class="text-gray-500 border-b border-gray-300 mb-3">Please fill in your order information</p>


                        <app-text-input label="Contact Name" formControlName="contactName" type="text"
                            backgroundColor="white" />
                        <app-text-input label="Email" formControlName="contactEmail" type="email" backgroundColor="white" />
                    </div>

                    <div class="rounded-lg bg-white p-6 shadow-sm mt-3 mb-3">
                        <h1 class="text-xl font-bold">DeliveryMethod</h1>
                        <p class="text-gray-500 border-b border-gray-300">Please fill in the shipping information</p>

                        <mat-radio-group [value]="cartService.selectedDeliveryMethod()?.id"
                            (change)="updateDeliveryMethod($event.value)"
                            class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-3">
                            @for (method of checkoutService.deliveryMethods; track method.id) {
                            <label
                                class="p-3 border border-gray-200 cursor-pointer w-full h-full hover:bg-blue-50 rounded-lg transition-all duration-200 relative">
                                <mat-radio-button class="w-full h-full"
                                    [checked]="cartService.selectedDeliveryMethod() === method" [value]="method">

                                    <div class="flex flex-col w-full h-full">
                                        <strong>{{ method.shortName }} - {{ method.price }}â‚´</strong>
                                        <span class="text-sm text-gray-500">{{ method.description }}</span>
                                    </div>
                                </mat-radio-button>
                            </label>
                            }

                        </mat-radio-group>
                        @if (checkoutForm.get('deliveryMethodId')?.value !== 3) {
                        <div class="mt-4">
                            <app-text-input label="Delivery Address" formControlName="deliveryAddress" type="text"
                                backgroundColor="white" />
                        </div>
                        }

                    </div>
                </form>

            </div>
            <div class="lg:w-1/3">
                <app-order-summary></app-order-summary>
                
                <button type="submit" form="checkoutForm" [disabled]="!checkoutForm.valid"
                    class="w-full py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 cursor-pointer mt-3">
                    Submit Order
                </button>

            </div>
        </div>

    </div>
}